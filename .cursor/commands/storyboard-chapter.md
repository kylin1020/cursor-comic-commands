# storyboard-chapter

## 📋 任务清单

执行此命令时，请按照以下顺序完成任务，每完成一项就勾选：

### 阶段1：章节分析与验证
- [ ] 接收章节信息：获取用户指定的章节编号和章节内容
- [ ] 验证项目结构：确认项目已通过 `/init-comic` 初始化，角色和场景设定文件存在
- [ ] 分析章节内容：理解章节的故事情节、节奏、关键事件和情感变化
- [ ] 确定分镜数量：根据内容长度和情节复杂度，建议合理的分镜数量（通常10-30个）

### 阶段2：分镜拆分与脚本生成
- [ ] 划分故事单元：将章节内容按照场景变化、情节转折、时间推进等因素划分成多个镜头
- [ ] 为每个分镜编写脚本：包含镜头描述、角色动作、对白、情感表达、镜头类型
- [ ] 确定镜头类型：为每个分镜指定类型（特写/近景/中景/远景/全景等）
- [ ] 标注关键信息：记录每个分镜涉及的角色、场景、时长建议、转场方式

### 阶段3：前帧与尾帧图片提示词生成
- [ ] 生成前帧图片提示词：为每个分镜创建开始画面的AI图像生成提示词
- [ ] 生成尾帧图片提示词：为每个分镜创建结束画面的AI图像生成提示词
- [ ] 确保视觉连贯性：检查相邻分镜的前帧和尾帧在视觉上的自然过渡
- [ ] 应用风格一致性：所有提示词都遵循 `style.md` 中定义的视觉风格
- [ ] 引用角色和场景：确保提示词中正确引用 `characters/` 和 `scenes/` 中的角色和场景设定

### 阶段4：视频片段提示词生成
- [ ] 分析动作和变化：识别每个分镜中的动作、镜头移动、画面变化
- [ ] 生成视频生成提示词：为每个分镜创建从前帧到尾帧的动态过渡描述
- [ ] 描述运动轨迹：明确角色动作、镜头运动（推拉摇移跟）、画面变化
- [ ] 标注动画关键点：记录需要特别注意的动画效果、表情变化、光影变化

### 阶段5：输出与验收
- [ ] 创建分镜脚本文件：在 `chapters/chapter-<章节号>/` 目录下创建完整的分镜脚本markdown文件
- [ ] 创建提示词输出目录：在 `outputs/chapters/chapter-<章节号>/storyboard/` 创建输出目录
- [ ] 生成分镜概览表格：创建包含所有分镜信息的表格视图
- [ ] 展示完成情况：向用户展示分镜脚本概览和下一步操作建议

---

## 📌 分镜脚本设计原则

### 分镜拆分的基本规则

1. **场景切换原则**
   - 地点改变 → 新分镜
   - 时间跳跃 → 新分镜
   - 视角大幅度变化 → 新分镜

2. **情节节奏控制**
   - 快节奏动作场景：分镜较短，切换频繁（3-5秒/镜头）
   - 对话场景：分镜适中，反打镜头切换（5-10秒/镜头）
   - 情感场景：分镜较长，保持沉浸感（10-15秒/镜头）
   - 环境渲染场景：分镜长，展示氛围（10-20秒/镜头）

3. **镜头语言运用**
   - **特写（Close-up）**：强调表情、细节、情绪
   - **近景（Close shot）**：角色肩部以上，表现对话
   - **中景（Medium shot）**：角色腰部以上，表现动作和互动
   - **远景（Long shot）**：角色全身，表现环境关系
   - **全景（Wide shot）**：大场景，建立空间感
   - **过肩镜头（Over-the-shoulder）**：表现对话互动
   - **主观镜头（POV）**：第一人称视角，增强代入感

4. **转场方式设计**
   - 直接切换（Cut）：最常用，快速自然
   - 淡入淡出（Fade）：时间流逝、场景重大变化
   - 叠化（Dissolve）：时空转换、回忆闪回
   - 擦除（Wipe）：风格化转场
   - 匹配剪辑（Match Cut）：视觉上的巧妙过渡

### 前帧与尾帧的设计要点

**前帧（First Frame）**：
- 必须清晰展示镜头的起始状态
- 包含必要的视觉信息：角色位置、环境、光线、情绪
- 与上一个分镜的尾帧在视觉上保持连贯（除非有转场）
- 静态画面，作为该镜头的关键帧

**尾帧（Last Frame）**：
- 展示镜头的结束状态
- 体现该镜头内发生的变化结果（动作完成、表情变化、位置移动等）
- 为下一个分镜的前帧做好铺垫
- 同样是静态画面，作为动作完成后的定格

**前帧与尾帧的关系**：
- 如果镜头内没有明显动作变化（如静态对话），前帧和尾帧可以类似或相同
- 如果镜头包含动作（如跑步、转身、拿起物品），前帧和尾帧应该明显不同
- 前帧和尾帧共同定义了该镜头的"起止点"，视频生成将在两者之间插值过渡

### 视频片段提示词的关键要素

视频生成提示词应该描述从前帧到尾帧的**动态过程**，包括：

1. **角色动作描述**
   - 具体的动作序列（如："慢慢抬起头，眼神从悲伤转为坚定"）
   - 动作的速度和力度（如："快速转身"、"轻柔地伸出手"）
   - 表情的变化过程（如："从惊讶到恐惧的渐变"）

2. **镜头运动描述**
   - 推镜头（Push in）：逐渐靠近主体，增强紧张感
   - 拉镜头（Pull out）：逐渐远离主体，展示更大环境
   - 摇镜头（Pan）：水平旋转，展示场景全貌
   - 移镜头（Track）：镜头跟随移动主体
   - 升降镜头（Tilt）：垂直旋转，展示高度关系
   - 固定镜头（Static）：镜头不动，只有角色或环境在变化

3. **画面变化描述**
   - 光影变化（如："阳光从窗外洒入，逐渐照亮房间"）
   - 景深变化（如："焦点从前景的花朵切换到背景的人物"）
   - 色彩变化（如："画面从温暖的金色渐变为冷峻的蓝色"）
   - 气氛渲染（如："雨滴开始落在窗上，气氛愈发凝重"）

4. **时间控制**
   - 建议每个镜头的时长（通常3-15秒）
   - 动作的节奏（快/中/慢）
   - 关键动作发生的时间点

**视频提示词示例**：
```
镜头从中景推进到近景。角色慢慢转过身来，表情从平静逐渐变为惊讶，眼睛睁大，嘴巴微张。背景从虚焦到清晰，显示出身后突然出现的人影。整个过程持续5秒，动作流畅自然。采用日系动漫风格，光影柔和，色彩明亮。
```

---

## 📐 提示词编写格式规范

### 前帧/尾帧图片提示词格式

**结构**：
```
[镜头类型]画面。[角色描述]，[角色动作/姿势]，[表情描述]。
[场景环境描述]。[光线和氛围]。[镜头角度和构图]。
[风格要求]，[质量要求]。
```

**要点**：
- 使用完整的自然语言句子
- 详细但简洁地描述画面内容
- 引用角色设定文件中的外貌特征（发型、发色、服装等）
- 引用场景设定文件中的环境特征
- 明确标注镜头类型（特写/近景/中景/远景/全景）
- 遵循 `style.md` 中的风格定义
- 控制在300-500字以内

**中文示例（中景镜头的前帧）**：
```
中景画面。画面中是20岁的李小明，他有着短黑色头发和棕色眼睛，穿着白色衬衫和深色长裤。他站在咖啡厅内，双手放在身体两侧，表情平静自然，目光看向前方。背景是温馨的咖啡厅环境，木质桌椅，柔和的暖色调灯光。镜头正面拍摄，构图将角色放在画面中心偏左位置。采用日系动漫风格，线条清晰，色彩温暖明亮，高质量精细画面。
```

**中文示例（中景镜头的尾帧）**：
```
中景画面。画面中是20岁的李小明，他有着短黑色头发和棕色眼睛，穿着白色衬衫和深色长裤。他站在咖啡厅内，身体微微前倾，右手抬起指向前方，表情惊讶，眼睛睁大，嘴巴微张。背景是温馨的咖啡厅环境，木质桌椅，柔和的暖色调灯光。镜头正面拍摄，构图将角色放在画面中心偏左位置。采用日系动漫风格，线条清晰，色彩温暖明亮，高质量精细画面。
```

### 视频片段提示词格式

**结构**：
```
[镜头类型]镜头，[镜头运动方式]。[从前帧到尾帧的动作变化描述]。
[表情和情绪的变化过程]。[环境或光影的变化]。
[时长建议]，[动作节奏]。[风格要求]。
```

**要点**：
- 描述从前帧到尾帧的**过渡过程**
- 强调动作的连贯性和自然性
- 明确镜头运动方式（推/拉/摇/移/固定）
- 描述画面的动态变化（不是静态描述）
- 控制在200-400字以内

**中文示例（对应上面的前帧到尾帧）**：
```
中景镜头，镜头保持固定。李小明从平静站立状态开始，听到什么声音后身体微微前倾，右手从身体两侧慢慢抬起并指向前方，动作流畅。他的表情从平静自然逐渐变为惊讶，眼睛逐渐睁大，嘴巴微微张开。背景的咖啡厅环境保持不变，光线柔和稳定。整个过程持续约4秒，动作节奏适中，表现出突然发现某事的反应。采用日系动漫风格，动作流畅自然，符合角色性格。
```

---

## 🎬 分镜脚本输出格式

每个章节的分镜脚本将保存为 `chapters/chapter-<章节号>/storyboard.md`，格式如下：

```markdown
# 第X章分镜脚本

**章节标题**：<章节标题>
**章节概要**：<简要描述章节主要内容>
**总分镜数**：<总数>
**预估总时长**：<分钟>

---

## 分镜概览表格

| 分镜号 | 镜头类型 | 场景 | 角色 | 时长 | 简要描述 |
|-------|---------|------|------|------|---------|
| 001 | 远景 | 咖啡厅 | 李小明 | 5秒 | 建立环境，展示咖啡厅全景 |
| 002 | 中景 | 咖啡厅 | 李小明 | 4秒 | 李小明走向座位 |
| ... | ... | ... | ... | ... | ... |

---

## 详细分镜脚本

### 【分镜 001】

**镜头类型**：远景（Wide shot）
**场景**：咖啡厅（参考：`scenes/咖啡厅.md`）
**角色**：李小明（参考：`characters/李小明.md`）
**时长建议**：5秒
**转场方式**：淡入（Fade in）

**分镜描述**：
咖啡厅的远景全景镜头，展示整个咖啡厅的温馨环境。李小明从画面右侧的门口走进来，身影较小，在画面右侧。咖啡厅内有几位顾客在安静地喝咖啡，暖色调的灯光营造出舒适的氛围。

**对白/旁白**：
（背景音乐响起，轻柔的爵士乐）

**情绪/氛围**：平静、温馨、日常

---

#### 前帧图片提示词

**文件路径**：`outputs/chapters/chapter-<章节号>/storyboard/shot-001-first.png`

**提示词**：
```
远景画面。画面中是一个温馨的咖啡厅内景，采用远景全景视角。咖啡厅内有木质桌椅、吧台、咖啡机等设备，几位顾客坐在不同位置安静地喝咖啡。暖色调的灯光从吊灯和壁灯发出，营造出舒适温暖的氛围。画面右侧的玻璃门刚刚打开，20岁的李小明（短黑色头发，棕色眼睛，白色衬衫，深色长裤）刚走进门口，身影在画面右侧较小。镜头为远景固定机位，俯视角度，展示整个空间的全貌。采用日系动漫风格，色彩温暖明亮，线条清晰，高质量精细画面。
```

---

#### 尾帧图片提示词

**文件路径**：`outputs/chapters/chapter-<章节号>/storyboard/shot-001-last.png`

**提示词**：
```
远景画面。画面中是同一个温馨的咖啡厅内景，采用远景全景视角。咖啡厅内的环境、其他顾客和光线保持不变。20岁的李小明（短黑色头发，棕色眼睛，白色衬衫，深色长裤）已经走到了画面中央偏右的位置，正朝着左侧的座位走去，背影姿态自然。玻璃门已经关闭。镜头为远景固定机位，俯视角度，保持与前帧一致的视角。采用日系动漫风格，色彩温暖明亮，线条清晰，高质量精细画面。
```

---

#### 视频片段提示词

**文件路径**：`outputs/chapters/chapter-<章节号>/storyboard/shot-001-video.txt`

**提示词**：
```
远景镜头，固定机位，俯视角度。画面从淡入开始，逐渐清晰。李小明从画面右侧的咖啡厅门口走进来，推开玻璃门，门缓缓打开。他走入咖啡厅内，身体自然移动，步伐从容。镜头跟随他的移动，他从画面右侧边缘走到中央偏右位置，朝着左侧的座位走去。背景中的其他顾客保持静态或有细微动作（喝咖啡、看书），营造日常感。暖色调灯光保持稳定，整体氛围温馨平静。整个过程持续5秒，动作节奏缓慢从容，建立场景的空间感和氛围。采用日系动漫风格，动作流畅自然，色彩温暖明亮。
```

---

### 【分镜 002】

（以此类推，为每个分镜创建完整的脚本和提示词）

...

---

## 输出目录结构

分镜脚本完成后，将在以下目录生成输出文件：

```
outputs/chapters/chapter-<章节号>/storyboard/
├── shot-001-first.png     # 分镜001的前帧图片（生成后）
├── shot-001-last.png      # 分镜001的尾帧图片（生成后）
├── shot-001-video.txt     # 分镜001的视频生成提示词
├── shot-002-first.png     # 分镜002的前帧图片（生成后）
├── shot-002-last.png      # 分镜002的尾帧图片（生成后）
├── shot-002-video.txt     # 分镜002的视频生成提示词
├── ...
└── storyboard-overview.md # 分镜概览文档（可选）
```

```

---

## 执行说明

我需要你帮我为指定章节创建分镜脚本，并生成前帧、尾帧图片提示词和视频片段提示词。

### 使用前提

1. **项目已初始化**：确保已经通过 `/init-comic` 命令初始化项目，存在：
   - `style.md` - 风格定义文件
   - `characters/` - 角色设定目录
   - `scenes/` - 场景设定目录

2. **角色和场景已定义**：章节中涉及的所有角色和场景都应该已经在 `characters/` 和 `scenes/` 中定义好

### 第一步：提供章节信息

请提供以下信息：
1. **章节编号**：第几章（如：1、2、3...）
2. **章节标题**：章节的标题
3. **章节内容**：完整的章节文本内容（可以是小说原文，也可以是改编后的脚本）

**示例**：
```
章节编号：1
章节标题：初遇咖啡厅
章节内容：
下午三点，阳光透过咖啡厅的玻璃窗洒进来，李小明推开门走了进来。
咖啡厅里很安静，只有轻柔的爵士乐在流淌。他环顾四周，寻找一个合适的座位。
突然，他的目光被角落里的一个女孩吸引住了...
（继续提供完整内容）
```

### 第二步：确认分镜数量和节奏

我会根据章节内容，建议合理的分镜数量。通常：
- **短章节**（500-1000字）：10-15个分镜
- **中等章节**（1000-2000字）：15-25个分镜
- **长章节**（2000字以上）：25-40个分镜

你可以：
- 接受我的建议
- 要求增加分镜（更细腻的叙事）
- 要求减少分镜（更快的节奏）

### 第三步：确认特殊要求

如果有以下特殊要求，请告知：
- 需要特别强调的情感场景
- 需要慢动作或特殊效果的镜头
- 特定的镜头语言偏好（如：多用特写、避免远景等）
- 配乐或音效建议
- 转场方式偏好

### 第四步：生成分镜脚本

我会：
1. 分析章节内容，识别关键情节点和情绪变化
2. 将内容拆分成合理数量的分镜
3. 为每个分镜：
   - 确定镜头类型（特写/近景/中景/远景/全景）
   - 编写分镜描述（画面内容、角色动作、环境）
   - 记录对白和旁白
   - 标注情绪和氛围
   - 生成前帧图片提示词
   - 生成尾帧图片提示词
   - 生成视频片段提示词
4. 创建分镜概览表格
5. 生成完整的分镜脚本文档

### 第五步：验收和调整

完成后，我会展示：
1. **分镜概览表格** - 快速浏览所有分镜
2. **详细分镜脚本** - 包含所有分镜的完整信息和提示词
3. **输出目录结构** - 告知文件保存位置

如果你对某些分镜不满意，可以要求：
- 调整某个分镜的镜头类型
- 修改某个分镜的时长
- 重新生成某个提示词
- 拆分或合并某些分镜

### 第六步：后续操作建议

分镜脚本创建完成后，你可以：
1. **生成图片**：使用图像生成AI（如SeedDream、Midjourney、Stable Diffusion等）批量生成所有前帧和尾帧图片
2. **生成视频**：使用视频生成AI（如Runway、Pika、Stable Video Diffusion等），利用前帧和尾帧图片+视频提示词生成每个分镜的视频片段
3. **视频剪辑**：将所有生成的视频片段按照分镜顺序剪辑成完整的章节视频
4. **添加音效和配乐**：根据分镜脚本中的情绪和氛围，添加合适的音效和背景音乐
5. **添加对白和字幕**：根据分镜脚本中的对白内容，添加配音或字幕

---

## ⚠️ 注意事项

### 视觉连贯性
- 相邻分镜的前帧和尾帧必须在视觉上保持连贯
- 角色的服装、发型、外貌在同一场景内不应突变
- 光线和色调在同一时间段内应保持一致

### 镜头逻辑性
- 遵循180度轴线原则（避免跳轴）
- 合理使用正反打镜头（对话场景）
- 避免不必要的镜头跳跃

### 提示词质量
- 每个提示词都要足够详细，能让AI准确生成目标画面
- 引用角色和场景设定文件，保持一致性
- 遵循 `style.md` 的风格定义

### 时长控制
- 单个分镜不宜过长（一般不超过15秒）
- 快节奏场景用短分镜，慢节奏场景用长分镜
- 总时长要合理（一般章节控制在3-8分钟）

### 技术可行性
- 考虑当前AI视频生成技术的限制（通常3-10秒）
- 避免过于复杂的动作或特效
- 优先使用静态或简单动作，复杂动作可拆分多个分镜

---

## 📚 参考资源

### 推荐学习资源
- 分镜基础：了解电影和动画的分镜语言
- 镜头语言：学习不同镜头类型的情感表达
- 转场技巧：掌握各种转场方式的使用场景

### 工具推荐
- **图像生成**：SeedDream 4.0、Midjourney、DALL-E、Stable Diffusion
- **视频生成**：Runway Gen-3、Pika、Stable Video Diffusion、Luma Dream Machine
- **视频剪辑**：Premiere Pro、Final Cut Pro、DaVinci Resolve、剪映

---

**准备好了吗？** 请提供章节信息，让我们开始创建分镜脚本吧！

